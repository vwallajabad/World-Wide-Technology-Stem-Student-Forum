<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberBuddy | Chat</title>
    <link rel="stylesheet" href="chatbot.css">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/cyberbuddy-180.png">
    <meta name="theme-color" content="#000000">

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://unpkg.com/typewriter-effect@2.3.1/dist/core.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-analytics-compat.js"></script>
</head>

<body>
    <h1 id="header"></h1>
    <div class="chat-container" id="chatbot-container">
        <div class="messages" id="messages"></div>
        <div class="input-container">
            <input type="text" id="userInput" placeholder="Message CyberBuddy...">
            <button onclick="sendMessage()">Send</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            console.log("DOM fully loaded and parsed");

            function getURLParameter(name) {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get(name);
            }

            function decodeURL() {
                let encodedText = document.getElementById("encodedInput")?.value;
                if (encodedText) {
                    let decodedText = decodeURIComponent(encodedText);
                    let messagesElement = document.getElementById("messages");
                    if (messagesElement) {
                        messagesElement.innerHTML = decodedText;
                    }
                }
            }

            window.onload = function () {
                let urlText = getURLParameter('text');
                if (urlText) {
                    let decodedText = decodeURIComponent(urlText);
                    document.getElementById("messages").innerHTML = decodedText;
                }
            };

            const firebaseConfig = {
                apiKey: "AIzaSyAA0JHy0cT9q2YTzOniLl_tV8_Gjh0E1mc",
                authDomain: "wwt-stem-student-forum.firebaseapp.com",
                projectId: "wwt-stem-student-forum",
                storageBucket: "wwt-stem-student-forum.firebasestorage.app",
                messagingSenderId: "61290200062",
                appId: "1:61290200062:web:a6e19e279bd912b2ee5eaf",
                measurementId: "G-T3C74BWRE5"
            };
            if (window.firebase) {
                firebase.initializeApp(firebaseConfig);
                firebase.analytics();
            }
        });
    </script>

    <script src="chatbot.js"></script>
</body>

</html>